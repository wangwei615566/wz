<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- sys_config表:系统参数表模块 -->
<mapper namespace="com.wz.cashloan.core.mapper.SysConfigMapper">
    <!--xml内部引用别名-->
	<!--返回MAP-->		
	<resultMap id="SysConfigMap" type="com.wz.cashloan.system.domain.SysConfig">
			<id column="id" property="id" jdbcType="BIGINT"/>
			<result column="creator" property="creator" jdbcType="BIGINT"/>
			<result column="name" property="name" jdbcType="VARCHAR"/>
			<result column="code" property="code" jdbcType="VARCHAR"/>
			<result column="value" property="value" jdbcType="VARCHAR"/>
			<result column="type" property="type" jdbcType="TINYINT"/>
			<result column="remark" property="remark" jdbcType="VARCHAR"/>
			<result column="state" property="status" jdbcType="TINYINT"/>
	</resultMap>
	
	<!-- 动态查询 -->
	<sql id="Select">
		<trim prefix="where" prefixOverrides="and|or">
					<if test="id !='' and id !=null">
                        id in (${id})
                    </if>
		            <if test="creator !='' and creator !=null">
		            	and creator = #{creator}
		            </if>
		            <if test="name !='' and name !=null">
		            	and name like CONCAT('%','${name}','%') 
		            </if>
		            <if test="code !='' and code !=null">
		            	and code = #{code}
		            </if>
		            <if test="value !='' and value !=null">
		            	and value = #{value}
		            </if>
		            <if test="type !='' and type !=null">
		            	and type = #{type}
		            </if>
		            <if test="remark !='' and remark !=null">
		            	and remark = #{remark}
		            </if>
		            <if test="state !=null">
		            	and state = #{state}
		            </if>
		</trim>
	</sql>
	
    <!-- 动态插入键 -->
    <sql id="InsertKey">
                   <if test="creator != null">		creator		</if>
                   <if test="name !='' and name != null">		,name		</if>
                   <if test="code !='' and code != null">		,code		</if>
                   <if test="value !='' and value != null">		,value		</if>
                   <if test="type !='' and type != null">		,type		</if>
                   <if test="remark !='' and remark != null">		,remark		</if>
                   <if test="state != null">		,state		</if>
    </sql>
    
    <!-- 动态插入值 -->
    <sql id="InsertValue">
                   <if test="creator != null" >		#{creator}		</if>
                   <if test="name !='' and name != null" >		,#{name}		</if>
                   <if test="code !='' and code != null" >		,#{code}		</if>
                   <if test="value !='' and value != null" >		,#{value}		</if>
                   <if test="type !='' and type != null" >		,#{type}		</if>
                   <if test="remark !='' and remark != null" >		,#{remark}		</if>
                   <if test="state != null" >		,#{state}		</if>
    </sql>
    
    <!-- 动态更新 -->
    <sql id="Update">
       <trim prefix="set" suffixOverrides=",">
				<if test="id != '' and id!= null">		 id=#{id}		</if>
            	<if test="creator != '' and creator!= null">		,creator=#{creator}		</if>
            	<if test="name != '' and name!= null">		,name=#{name}		</if>
            	<if test="code != '' and code!= null">		,code=#{code}		</if>
            	<if test="value != '' and value!= null">		,value=#{value}		</if>
            	<if test="type != '' and type!= null">		,type=#{type}		</if>
            	<if test="remark != '' and remark!= null">		,remark=#{remark}		</if>
            	<if test="state!= null">		,state=#{state}		</if>
       </trim>
    </sql>
    
    <!-- 动态排序 -->
    <sql id="Sort">
        <if  test="fields != '' and fields != null">
            order by ${fields}
        </if >
        <if test="rule != '' and rule != null">
            ${rule}
        </if>
    </sql>
    
	<!-- 动态的插入,必须要创建时间 -->
	<insert id="save" parameterType="com.wz.cashloan.system.domain.SysConfig">
		insert into sys_config
        (
        <include refid="InsertKey"/>
        )values(
        <include refid="InsertValue"/>
        )
       	<selectKey resultType="long" keyProperty="id">
			SELECT LAST_INSERT_ID() AS id
		</selectKey>

	</insert>

    <!-- 动态更新 -->
    <update id="update" parameterType="com.wz.cashloan.system.domain.SysConfig">
        update sys_config
        <include refid="Update"/>
        where id = #{id}
    </update>

    <!-- 动态查询 -->
    <select id="select" parameterType="java.util.HashMap" resultMap="SysConfigMap">
        select * from sys_config 
        <include refid="Select"/>
        <include refid="Sort"/>
    </select>
    
    <!-- 根据code查询  -->
    <select id="selectByCode" parameterType="String" resultMap="SysConfigMap">
        select * from sys_config where code = #{code}
    </select>
    
    <!-- 返回总数 -->
    <select id="total" parameterType="java.util.HashMap" resultType="java.lang.Integer">
        select count(*) from sys_config 
        <include refid="Select"/>
        <include refid="Sort"/>
    </select>
    
    <!-- 根据code模糊查询  -->
    <select id="listByCode" resultMap="SysConfigMap" parameterType="String" >
        select * from sys_config where code like concat('',#{code}, '%')
    </select>
    
    
    <select id="listSelective" resultMap="SysConfigMap" parameterType="java.util.HashMap" >
        select * from sys_config 
        <include refid="Select"/>
    </select>

    <!--根据ID删除-->
    <delete id="delete">
        delete from sys_config
        where
        id  = #{id}
    </delete>
    
    <select id="findAll" resultMap="SysConfigMap">
    	select * from sys_config where state = 1
    </select>

    <!--查询系统的版本号-->
    <select id="findSysVersionCode" resultType="String">
        select version_code from sys_version_info   order by id desc limit 1
    </select>
</mapper> 
